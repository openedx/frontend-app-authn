/**
 * This file contains data for auto generated username Optimizely experiment
 */
import { getConfig } from '@edx/frontend-platform';

export const NOT_INITIALIZED = 'experiment-not-initialized';
export const CONTROL = 'control-registration-page';
export const AUTO_GENERATED_USERNAME_REGISTRATION_EXP_VARIATION = 'auto-generated-username-register-page';
const AUTO_GENERATED_USERNAME_EXP_PAGE = 'targeting_for_auto_generated_username_page';

export function getAutoGeneratedUsernameExperimentVariation() {
  try {
    if (window.optimizely
        && window.optimizely.get('data').experiments[getConfig().AUTO_GENERATED_USERNAME_EXPERIMENT_ID]) {
      const selectedVariant = window.optimizely.get('state').getVariationMap()[
        getConfig().AUTO_GENERATED_USERNAME_EXPERIMENT_ID
      ];
      return selectedVariant?.name;
    }
  } catch (e) { /* empty */ }
  return '';
}

export function activateAutoGeneratedUsernameExperiment() {
  window.optimizely = window.optimizely || [];
  window.optimizely.push({
    type: 'page',
    pageName: AUTO_GENERATED_USERNAME_EXP_PAGE,
  });
}
